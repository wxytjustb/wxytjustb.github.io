<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-ai-dev/Laminar/laminar" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Laminar | Compass</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://roky.wang/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://roky.wang/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://roky.wang/docs/ai-dev/Laminar/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Laminar | Compass"><meta data-rh="true" name="description" content="A tutorial to get you started with Laminar"><meta data-rh="true" property="og:description" content="A tutorial to get you started with Laminar"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://roky.wang/docs/ai-dev/Laminar/"><link data-rh="true" rel="alternate" href="https://roky.wang/docs/ai-dev/Laminar/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://roky.wang/docs/ai-dev/Laminar/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Laminar","item":"https://roky.wang/docs/ai-dev/Laminar/"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Compass RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Compass Atom Feed"><link rel="stylesheet" href="/assets/css/styles.de036743.css">
<script src="/assets/js/runtime~main.7eadaacf.js" defer="defer"></script>
<script src="/assets/js/main.20bc86f5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">指南针Compass</b></a><a class="navbar__item navbar__link" href="/home">首页</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/ai-dev/Laminar/">🤖 AI 开发</a><a class="navbar__item navbar__link" href="/docs/cloud-native/intro">☁️ 云开发</a><a class="navbar__item navbar__link" href="/tools">📦 工具箱</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/ai-dev/Laminar/"><span title="🤖 AI 开发" class="categoryLinkLabel_W154">🤖 AI 开发</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ai-dev/Laminar/"><span title="Laminar" class="linkLabel_WmDU">Laminar</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/ai-dev/claude-code/"><span title="使用claude code 进行开发" class="categoryLinkLabel_W154">使用claude code 进行开发</span></a><button aria-label="展开侧边栏分类 &#x27;使用claude code 进行开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai-dev/n8n"><span title="n8n" class="linkLabel_WmDU">n8n</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ai-dev/dify"><span title="Dify" class="linkLabel_WmDU">Dify</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/ai-dev/github-copilot/code-review"><span title="github-copilot" class="categoryLinkLabel_W154">github-copilot</span></a></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">🤖 AI 开发</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Laminar</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Laminar AI 平台使用指南</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-简介">📖 简介<a href="#-简介" class="hash-link" aria-label="📖 简介的直接链接" title="📖 简介的直接链接" translate="no">​</a></h2>
<p>Laminar 是一个面向 <strong>LLM 应用开发全流程</strong> 的开源平台，它更像是你的「LLM 应用中控台」：<br>
<!-- -->从本地开发、联调测试，到线上观测、问题排查，都可以在一个统一界面里完成。</p>
<p>你可以把 Laminar 理解为：</p>
<ul>
<li class="">对开发者：一个 <strong>观察、调试和优化 LLM 调用</strong> 的工具箱</li>
<li class="">对团队：一个 <strong>统一记录 Prompt / 日志 / 评估结果</strong> 的协作平台</li>
</ul>
<p>它本身 <strong>不代替你的模型提供商（OpenAI、DeepSeek、Ollama 等）</strong>，而是站在这些模型之上，帮助你更好地管理和改进你的 AI 功能。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="核心能力概览">核心能力概览<a href="#核心能力概览" class="hash-link" aria-label="核心能力概览的直接链接" title="核心能力概览的直接链接" translate="no">​</a></h3>
<ul>
<li class="">
<p>🔍 <strong>调用观测与实时监控</strong><br>
<!-- -->记录每一次 LLM 调用的输入、输出、耗时、错误等信息，帮助你快速定位「哪里慢、哪里错」。</p>
</li>
<li class="">
<p>🧪 <strong>提示词（Prompt）管理与版本控制</strong><br>
<!-- -->将提示词当作“代码”来管理：版本记录、对比效果、回滚历史版本，避免线上乱改 Prompt。</p>
</li>
<li class="">
<p>📊 <strong>评估与回归测试</strong><br>
<!-- -->支持对 LLM 输出进行自动或半自动评估（如打分、标签、通过/失败），用于对比不同模型、不同 Prompt 的效果，做「A/B 实验」或回归测试。</p>
</li>
<li class="">
<p>🔄 <strong>调用链路追踪（Tracing）</strong><br>
<!-- -->如果你的应用里有多步调用（例如：检索 → 重写查询 → 调模型 → 后处理），Laminar 可以把整条链路串起来，方便排查「是哪里出了问题」。</p>
</li>
<li class="">
<p>📈 <strong>数据与成本分析</strong><br>
<!-- -->从全局视角查看某个应用、某个模型、某个 Prompt 的：调用量、成功率、平均耗时、Token 消耗等，帮助你在质量和成本之间做取舍。</p>
</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="️-本地部署-laminar-服务器">🏗️ 本地部署 Laminar 服务器<a href="#️-本地部署-laminar-服务器" class="hash-link" aria-label="🏗️ 本地部署 Laminar 服务器的直接链接" title="🏗️ 本地部署 Laminar 服务器的直接链接" translate="no">​</a></h2>
<p>如果你希望在本地或私有环境中部署 Laminar，而不使用云端服务，可以按照以下步骤使用 Docker Compose 进行自托管部署。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="-部署流程概览">📋 部署流程概览<a href="#-部署流程概览" class="hash-link" aria-label="📋 部署流程概览的直接链接" title="📋 部署流程概览的直接链接" translate="no">​</a></h3>
<p>完整的部署流程包含以下 5 个步骤：</p>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph LR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[1. 克隆仓库] --&gt; B[2. 生成密钥]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; C[3. 配置.env]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; D[4. 启动服务]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; E[5. Web初始化]</span><br></span></code></pre></div></div>
<table><thead><tr><th>步骤</th><th>内容</th><th>说明</th></tr></thead><tbody><tr><td><strong>步骤 1</strong></td><td>克隆仓库</td><td>从 GitHub 克隆 Laminar 官方仓库</td></tr><tr><td><strong>步骤 2</strong></td><td>生成密钥</td><td>使用 <code>openssl</code> 生成安全密钥</td></tr><tr><td><strong>步骤 3</strong></td><td>配置 .env</td><td>填入密钥和其他配置参数</td></tr><tr><td><strong>步骤 4</strong></td><td>启动服务</td><td>选择合适的 docker-compose 文件启动</td></tr><tr><td><strong>步骤 5</strong></td><td>Web 初始化</td><td>在浏览器中完成账户创建和配置</td></tr></tbody></table>
<blockquote>
<p>⏱️ <strong>预计时间</strong>：整个部署流程大约需要 10-15 分钟（不包括下载镜像的时间）</p>
</blockquote>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="使用-docker-compose-部署">使用 Docker Compose 部署<a href="#使用-docker-compose-部署" class="hash-link" aria-label="使用 Docker Compose 部署的直接链接" title="使用 Docker Compose 部署的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="前置要求">前置要求<a href="#前置要求" class="hash-link" aria-label="前置要求的直接链接" title="前置要求的直接链接" translate="no">​</a></h4>
<p>开始前请确认：</p>
<ul>
<li class="">已安装 <strong>Docker ≥ 20.10</strong></li>
<li class="">已安装 <strong>Docker Compose ≥ 2.0</strong></li>
<li class="">至少 <strong>4 GB 内存</strong>、<strong>10 GB 磁盘空间</strong></li>
<li class="">系统中可用 <code>openssl</code> 命令</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="步骤-1克隆仓库">步骤 1：克隆仓库<a href="#步骤-1克隆仓库" class="hash-link" aria-label="步骤 1：克隆仓库的直接链接" title="步骤 1：克隆仓库的直接链接" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/lmnr-ai/lmnr.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd lmnr</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="步骤-2生成安全密钥">步骤 2：生成安全密钥<a href="#步骤-2生成安全密钥" class="hash-link" aria-label="步骤 2：生成安全密钥的直接链接" title="步骤 2：生成安全密钥的直接链接" translate="no">​</a></h4>
<p>在项目目录下执行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;========================================&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;请将以下内容保存，稍后填入 .env 文件&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;========================================&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;SHARED_SECRET_TOKEN=$(openssl rand -base64 32)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;AEAD_SECRET_KEY=$(openssl rand -hex 32)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;NEXTAUTH_SECRET=$(openssl rand -hex 32)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;========================================&quot;</span><br></span></code></pre></div></div>
<blockquote>
<p>💡 <strong>提示</strong>：将生成的密钥复制保存，下一步配置时会用到。</p>
</blockquote>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="步骤-3配置环境变量">步骤 3：配置环境变量<a href="#步骤-3配置环境变量" class="hash-link" aria-label="步骤 3：配置环境变量的直接链接" title="步骤 3：配置环境变量的直接链接" translate="no">​</a></h4>
<p>编辑 <code>.env</code> 文件，配置关键参数：</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="1postgresql-配置">1、PostgreSQL 配置<a href="#1postgresql-配置" class="hash-link" aria-label="1、PostgreSQL 配置的直接链接" title="1、PostgreSQL 配置的直接链接" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 数据库配置 (PostgreSQL)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">POSTGRES_USER=postgres                  # PostgreSQL 用户名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">POSTGRES_PASSWORD=your_strong_password_here  # 🔒 修改为强密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">POSTGRES_DB=postgres                    # 数据库名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">POSTGRES_PORT=5433                      # PostgreSQL 端口（默认 5432，这里使用 5433 避免冲突）</span><br></span></code></pre></div></div>
<ul>
<li class=""><code>POSTGRES_USER</code>: 数据库用户名，用于应用连接数据库</li>
<li class=""><code>POSTGRES_PASSWORD</code>: 数据库密码，<strong>强烈建议使用复杂密码</strong></li>
<li class=""><code>POSTGRES_DB</code>: 数据库名称，存储应用的所有结构化数据</li>
<li class=""><code>POSTGRES_PORT</code>: 数据库端口，如果本地 5432 端口被占用可修改</li>
</ul>
<blockquote>
<p>💡 <strong>提示</strong>：如果使用 <code>docker-compose.yml</code>，你需要自己准备 PostgreSQL 数据库。如果使用 <code>docker-compose-full.yml</code>，PostgreSQL 会自动在 Docker 中启动。</p>
</blockquote>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="2rabbitmq-配置">2、RabbitMQ 配置<a href="#2rabbitmq-配置" class="hash-link" aria-label="2、RabbitMQ 配置的直接链接" title="2、RabbitMQ 配置的直接链接" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 消息队列配置 (RabbitMQ)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RABBITMQ_DEFAULT_USER=admin         # RabbitMQ 管理员用户名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RABBITMQ_DEFAULT_PASS=your_strong_password_here   # 🔒 修改为强密码</span><br></span></code></pre></div></div>
<ul>
<li class=""><code>RABBITMQ_DEFAULT_USER</code>: 管理员用户名，用于访问 RabbitMQ 管理界面</li>
<li class=""><code>RABBITMQ_DEFAULT_PASS</code>: 管理员密码，用于消息队列的身份验证</li>
<li class=""><strong>用途</strong>: 处理异步任务、跟踪数据上报等</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="3clickhouse-配置">3、ClickHouse 配置<a href="#3clickhouse-配置" class="hash-link" aria-label="3、ClickHouse 配置的直接链接" title="3、ClickHouse 配置的直接链接" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 数据分析引擎配置 (ClickHouse)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLICKHOUSE_USER=ch_user             # ClickHouse 读写用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLICKHOUSE_RO_USER=ch_user          # ClickHouse 只读用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLICKHOUSE_PASSWORD=your_strong_password_here       # 🔒 修改为强密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLICKHOUSE_RO_PASSWORD=your_strong_password_here    # 🔒 修改为强密码</span><br></span></code></pre></div></div>
<ul>
<li class=""><code>CLICKHOUSE_USER</code>: 具有读写权限的用户</li>
<li class=""><code>CLICKHOUSE_RO_USER</code>: 只读用户，用于数据查询和分析</li>
<li class=""><code>CLICKHOUSE_PASSWORD</code> / <code>CLICKHOUSE_RO_PASSWORD</code>: 对应用户的密码</li>
<li class=""><strong>用途</strong>: 存储和分析大量的追踪数据（traces）、性能指标等</li>
</ul>
<blockquote>
<p>💡 <strong>提示</strong>：ClickHouse 只在 <code>docker-compose-full.yml</code> 和 <code>docker-compose-local-dev-full.yml</code> 中包含。</p>
</blockquote>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="4安全密钥配置">4、安全密钥配置<a href="#4安全密钥配置" class="hash-link" aria-label="4、安全密钥配置的直接链接" title="4、安全密钥配置的直接链接" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 安全配置 🔴 将步骤2生成的密钥填入以下位置！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHARED_SECRET_TOKEN=paste_your_generated_token_here     # 🔴 粘贴生成的 SHARED_SECRET_TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># AEAD 加密密钥 - 必须是 32 字节（64 个十六进制字符）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AEAD_SECRET_KEY=paste_your_generated_aead_key_here      # 🔴 粘贴生成的 AEAD_SECRET_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># NextAuth 身份验证密钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NEXTAUTH_SECRET=paste_your_generated_nextauth_secret_here  # 🔴 粘贴生成的 NEXTAUTH_SECRET</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>⚠️ 重要</strong>：这三个密钥必须在步骤 2 中使用 <code>openssl</code> 命令生成，然后粘贴到 <code>.env</code> 文件中，不能使用任何示例值。</p>
</blockquote>
<table><thead><tr><th>变量名</th><th>用途</th><th>关键要求</th><th>生成方式</th></tr></thead><tbody><tr><td><code>SHARED_SECRET_TOKEN</code></td><td>服务间通信的共享密钥，用于校验微服务请求合法性</td><td>无固定格式要求</td><td><code>openssl rand -base64 32</code></td></tr><tr><td><code>AEAD_SECRET_KEY</code></td><td>敏感数据加密/解密（如 API Keys）</td><td><strong>必须为 64 个十六进制字符（32 字节）</strong></td><td><code>openssl rand -hex 32</code></td></tr><tr><td><code>NEXTAUTH_SECRET</code></td><td>NextAuth.js 会话管理与 JWT 签名</td><td>任意长度的随机字符串</td><td><code>openssl rand -hex 32</code></td></tr></tbody></table>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="5端口配置">5、端口配置<a href="#5端口配置" class="hash-link" aria-label="5、端口配置的直接链接" title="5、端口配置的直接链接" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 服务端口配置（可选，取消注释以覆盖默认端口）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">APP_SERVER_HOST_PORT=8000           # 后端 API 服务端口（默认端口是8000）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">APP_SERVER_GRPC_HOST_PORT=8001      # gRPC 服务端口（默认端口是8001）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FRONTEND_HOST_PORT=5667             # 前端 Web 界面端口（默认端口是5667）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QUERY_ENGINE_HOST_PORT=8903         # 查询引擎服务端口（默认端口是8903）</span><br></span></code></pre></div></div>
<p>这些变量用于控制 <strong>容器对宿主机暴露的端口</strong>。一般保持默认即可；只有端口冲突时才需要修改。</p>
<table><thead><tr><th>变量名</th><th style="text-align:right">默认值</th><th>对应服务</th><th>访问方式 / 备注</th></tr></thead><tbody><tr><td><code>APP_SERVER_HOST_PORT</code></td><td style="text-align:right"><code>8000</code></td><td>后端 REST API</td><td><code>http://localhost:8000</code></td></tr><tr><td><code>APP_SERVER_GRPC_HOST_PORT</code></td><td style="text-align:right"><code>8001</code></td><td>后端 gRPC</td><td>通常不需要浏览器访问</td></tr><tr><td><code>FRONTEND_HOST_PORT</code></td><td style="text-align:right"><code>5667</code></td><td>前端 Web</td><td><code>http://localhost:5667</code></td></tr><tr><td><code>QUERY_ENGINE_HOST_PORT</code></td><td style="text-align:right"><code>8903</code></td><td>查询引擎</td><td>内部使用为主，一般无需直接访问</td></tr></tbody></table>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="6第三方服务配置">6、第三方服务配置<a href="#6第三方服务配置" class="hash-link" aria-label="6、第三方服务配置的直接链接" title="6、第三方服务配置的直接链接" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 第三方服务配置（可选）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 取消注释并设置以启用 OpenAI 支持</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 目前用于 Next.js 中生成聊天名称等功能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># OPENAI_API_KEY=sk-your-openai-api-key</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="openai-集成可选"><strong>OpenAI 集成（可选）</strong><a href="#openai-集成可选" class="hash-link" aria-label="openai-集成可选的直接链接" title="openai-集成可选的直接链接" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">OPENAI_API_KEY=sk-your-openai-api-key</span><br></span></code></pre></div></div>
<ul>
<li class="">如果需要使用 AI 功能（如自动生成聊天名称、智能分析等），需要配置此项</li>
<li class="">从 <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener noreferrer" class="">OpenAI Platform</a> 获取 API Key</li>
</ul>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="-docker-compose-文件选择">📦 Docker Compose 文件选择<a href="#-docker-compose-文件选择" class="hash-link" aria-label="📦 Docker Compose 文件选择的直接链接" title="📦 Docker Compose 文件选择的直接链接" translate="no">​</a></h3>
<p>Laminar 官方仓库提供了多个 <code>docker-compose</code> 文件，适用于不同的部署场景。根据你的需求选择合适的文件：</p>
<table><thead><tr><th>文件名</th><th>用途</th><th>适用场景</th><th>说明</th></tr></thead><tbody><tr><td><code>docker-compose.yml</code></td><td><strong>生产部署</strong>（推荐）</td><td>快速部署生产环境</td><td>使用官方预构建镜像，启动速度快，适合直接部署使用</td></tr><tr><td><code>docker-compose-full.yml</code></td><td><strong>完整生产部署</strong></td><td>需要完整服务的生产环境</td><td>包含所有依赖服务（PostgreSQL、ClickHouse、RabbitMQ 等）</td></tr><tr><td><code>docker-compose-local-dev.yml</code></td><td><strong>本地开发</strong></td><td>开发人员本地开发调试</td><td>挂载本地代码目录，支持热重载，方便开发调试</td></tr><tr><td><code>docker-compose-local-dev-full.yml</code></td><td><strong>完整本地开发</strong></td><td>本地开发 + 所有依赖服务</td><td>本地开发环境 + 完整的数据库和消息队列服务</td></tr><tr><td><code>docker-compose-local-build.yml</code></td><td><strong>本地构建</strong></td><td>从源码构建镜像</td><td>不使用预构建镜像，从本地源码构建，适合定制化需求</td></tr></tbody></table>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="-选择指南">🎯 选择指南<a href="#-选择指南" class="hash-link" aria-label="🎯 选择指南的直接链接" title="🎯 选择指南的直接链接" translate="no">​</a></h4>
<p>大多数情况下推荐使用 <code>docker-compose-full.yml</code>，它包含了所有必需的服务，无需额外配置。</p>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="-快速配置检查清单">🔍 快速配置检查清单<a href="#-快速配置检查清单" class="hash-link" aria-label="🔍 快速配置检查清单的直接链接" title="🔍 快速配置检查清单的直接链接" translate="no">​</a></h3>
<p>部署前请确认以下配置项：</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->🔴 <strong>安全密钥已生成并填入</strong>：<code>SHARED_SECRET_TOKEN</code>、<code>AEAD_SECRET_KEY</code>、<code>NEXTAUTH_SECRET</code> 均为步骤 2 生成的随机值</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->所有密码已修改为强密码</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <code>AEAD_SECRET_KEY</code> 是 64 个十六进制字符</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->端口未被其他服务占用</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <code>.env</code> 文件权限设置为 600（<code>chmod 600 .env</code>）</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <code>.env</code> 已添加到 <code>.gitignore</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->如需使用 OpenAI，已配置有效的 API Key</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="步骤-4启动服务">步骤 4：启动服务<a href="#步骤-4启动服务" class="hash-link" aria-label="步骤 4：启动服务的直接链接" title="步骤 4：启动服务的直接链接" translate="no">​</a></h4>
<p>根据你的需求选择合适的 docker-compose 文件启动服务：</p>
<p><strong>推荐：默认配置</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用默认配置，需要自己准备 PostgreSQL 等服务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose -f docker-compose.yml up -d</span><br></span></code></pre></div></div>
<p><strong>或者：完整配置（包含完整配置）</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 启动应用 + PostgreSQL + ClickHouse + RabbitMQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose -f docker-compose-full.yml up -d</span><br></span></code></pre></div></div>
<p><strong>本地开发：</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 开发模式，代码修改实时生效</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose -f docker-compose-local-dev-full.yml up -d</span><br></span></code></pre></div></div>
<p><strong>查看服务状态：</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 查看所有容器状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose ps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看日志（实时）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose logs -f</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="步骤-5访问-web-界面并完成初始化">步骤 5：访问 Web 界面并完成初始化<a href="#步骤-5访问-web-界面并完成初始化" class="hash-link" aria-label="步骤 5：访问 Web 界面并完成初始化的直接链接" title="步骤 5：访问 Web 界面并完成初始化的直接链接" translate="no">​</a></h4>
<p>服务启动后，通过浏览器访问以下地址：</p>
<ul>
<li class=""><strong>前端 Web 界面</strong>：<a href="http://localhost:5667" target="_blank" rel="noopener noreferrer" class="">http://localhost:5667</a></li>
<li class=""><strong>后端 API 服务</strong>：<a href="http://localhost:8000" target="_blank" rel="noopener noreferrer" class="">http://localhost:8000</a></li>
<li class=""><strong>API 文档</strong>：<a href="http://localhost:8000/docs%EF%BC%88%E5%A6%82%E6%9E%9C%E5%8F%AF%E7%94%A8%EF%BC%89" target="_blank" rel="noopener noreferrer" class="">http://localhost:8000/docs（如果可用）</a></li>
</ul>
<p>在 Web 界面中完成以下操作：</p>
<ol>
<li class=""><strong>创建管理员账户</strong>（首次访问时）</li>
<li class=""><strong>获取 API Key</strong>：在设置页面创建项目的 API Key</li>
<li class=""><strong>配置项目</strong>：根据需要创建项目和配置追踪设置</li>
</ol>
<blockquote>
<p>💡 <strong>提示</strong>：所有的配置和管理操作都可以在 Web 界面中完成，无需手动执行数据库脚本。</p>
</blockquote>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="验证部署">验证部署<a href="#验证部署" class="hash-link" aria-label="验证部署的直接链接" title="验证部署的直接链接" translate="no">​</a></h3>
<p>部署完成后，通过以下步骤验证服务是否正常运行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. 检查 API 健康状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl http://localhost:8000/health</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. 检查前端是否可访问</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl http://localhost:3000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. 测试追踪数据上报</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST http://localhost:8000/api/v1/traces \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &quot;Content-Type: application/json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &quot;X-API-Key: YOUR_API_KEY&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;trace_id&quot;: &quot;test-trace-1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;spans&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;span_id&quot;: &quot;span-1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;name&quot;: &quot;test-span&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;start_time&quot;: &quot;2024-01-01T00:00:00Z&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;end_time&quot;: &quot;2024-01-01T00:00:01Z&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre></div></div>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="常见问题排查">常见问题排查<a href="#常见问题排查" class="hash-link" aria-label="常见问题排查的直接链接" title="常见问题排查的直接链接" translate="no">​</a></h3>
<p><strong>Q: 服务启动失败？</strong></p>
<p>A: 检查以下事项：</p>
<ul>
<li class="">端口是否被占用：<code>lsof -i :8000</code> 和 <code>lsof -i :3000</code></li>
<li class="">数据库连接是否正常：检查 PostgreSQL 和 Redis 是否运行</li>
<li class="">环境变量是否正确配置</li>
<li class="">查看详细日志：<code>docker-compose logs backend</code></li>
</ul>
<p><strong>Q: 追踪数据没有显示？</strong></p>
<p>A:</p>
<ul>
<li class="">验证 API Key 是否正确</li>
<li class="">检查网络连接</li>
<li class="">查看后端日志是否有错误</li>
<li class="">确认客户端 SDK 配置的 API URL 正确</li>
</ul>
<p><strong>Q: 部署在服务器上，无法通过服务器 IP 访问？</strong></p>
<p>A: 如果你在服务器上部署 Laminar，想通过服务器 IP 地址访问（如 <code>http://192.128.3.1:5667</code>），需要修改 <code>docker-compose.yml</code> 或 <code>docker-compose-full.yml</code> 文件中的以下环境变量：</p>
<p>找到 <code>frontend</code> 服务配置，修改这三个 URL：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">frontend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ghcr.io/lmnr</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ai/frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pull_policy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;${FRONTEND_HOST_PORT:-5667}:5667&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># ... 其他配置 ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># ... 其他环境变量 ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">NEXTAUTH_URL</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//你的服务器IP</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">5667</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># 修改这里</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">NEXT_PUBLIC_URL</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//你的服务器IP</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">5667</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic"># 修改这里</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">BACKEND_URL</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">8000</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 保持不变</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">BACKEND_RT_URL</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">8002</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic"># 保持不变</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># ... 其他环境变量 ...</span><br></span></code></pre></div></div>
<p><strong>示例</strong>：如果你的服务器 IP 是 <code>192.128.3.1</code>，则修改为：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">NEXTAUTH_URL</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//192.128.3.1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">5667</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">NEXT_PUBLIC_URL</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//192.128.3.1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">5667</span><br></span></code></pre></div></div>
<p>修改后重启服务：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose down</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果使用的是 docker-compose-full.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose -f docker-compose-full.yml up -d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#如果使用的是docker-compose.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up -d</span><br></span></code></pre></div></div>
<blockquote>
<p>💡 <strong>提示</strong>：</p>
<ul>
<li class=""><code>BACKEND_URL</code> 和 <code>BACKEND_RT_URL</code> 不需要修改，它们是容器内部通信地址</li>
<li class="">如果使用域名，将 IP 替换为域名即可</li>
<li class="">确保服务器防火墙已开放 5667 和 8000 端口</li>
</ul>
</blockquote>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-快速开始">🚀 快速开始<a href="#-快速开始" class="hash-link" aria-label="🚀 快速开始的直接链接" title="🚀 快速开始的直接链接" translate="no">​</a></h2>
<p>完成服务器部署后，需要在你的应用中集成 Laminar SDK 来开始追踪和监控 LLM 调用。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-获取-api-key">1. 获取 API Key<a href="#1-获取-api-key" class="hash-link" aria-label="1. 获取 API Key的直接链接" title="1. 获取 API Key的直接链接" translate="no">​</a></h3>
<p>在应用中使用 Laminar 之前，需要先获取 API Key：</p>
<ol>
<li class="">打开 Laminar Web 界面：<code>http://你的服务器IP:5667</code>，本地的话就是 <code>http://localhost:5667</code></li>
<li class="">登录后进入 <strong>Settings</strong> → <strong>API Keys</strong></li>
<li class="">点击 <strong>Create API Key</strong> 创建新的 API Key</li>
<li class="">复制生成的 API Key（只显示一次，请妥善保管）
<img decoding="async" loading="lazy" alt="alt text" src="/assets/images/laminar-image1-15be58e3239eb62a1b59a9401180adb1.png" width="3420" height="880" class="img_ev3q"></li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-配置环境变量">2. 配置环境变量<a href="#2-配置环境变量" class="hash-link" aria-label="2. 配置环境变量的直接链接" title="2. 配置环境变量的直接链接" translate="no">​</a></h3>
<p>在你的项目中创建 <code>.env</code> 文件，配置以下参数：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Laminar API Key（在 Laminar UI → Settings → API Keys 中创建）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LAMINAR_API_KEY=YOUR_PROJECT_API_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Laminar 服务器地址（你的服务器 IP 或域名）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LAMINAR_BASE_URL=http://YOUR_SERVER_IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Laminar HTTP 端口（对应 .env 中的 APP_SERVER_HOST_PORT，默认 8000））</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LAMINAR_HTTP_PORT=YOUR_HTTP_PORT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Laminar gRPC 端口（对应 .env 中的 APP_SERVER_GRPC_HOST_PORT，默认 8001）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LAMINAR_GRPC_PORT=YOUR_GRPC_PORT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 是否启用 Laminar 追踪</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LAMINAR_ENABLED=True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 环境名称（可选，用于区分开发/测试/生产环境）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LAMINAR_ENVIRONMENT=development</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="-配置项说明">📝 配置项说明<a href="#-配置项说明" class="hash-link" aria-label="📝 配置项说明的直接链接" title="📝 配置项说明的直接链接" translate="no">​</a></h4>
<table><thead><tr><th>配置项</th><th>必需</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>LAMINAR_API_KEY</code></td><td>✅</td><td>在 Laminar Web 界面创建的 API Key</td><td><code>sGTy9VFqpKqQk2yUUJ2K...</code></td></tr><tr><td><code>LAMINAR_BASE_URL</code></td><td>✅</td><td>Laminar 服务器的基础 URL（不包含端口）</td><td><code>http://localhost</code></td></tr><tr><td><code>LAMINAR_HTTP_PORT</code></td><td>✅</td><td>Laminar HTTP API 端口（默认 8000）</td><td><code>8000</code></td></tr><tr><td><code>LAMINAR_GRPC_PORT</code></td><td>✅</td><td>Laminar gRPC 端口（默认 8001）</td><td><code>8001</code></td></tr><tr><td><code>LAMINAR_ENABLED</code></td><td>❌</td><td>是否启用追踪（默认 True）</td><td><code>True</code> / <code>False</code></td></tr><tr><td><code>LAMINAR_ENVIRONMENT</code></td><td>❌</td><td>环境标识，用于区分不同部署环境</td><td><code>development</code> / <code>production</code></td></tr></tbody></table>
<blockquote>
<p>⚠️ <strong>重要提示</strong>：</p>
<ul>
<li class=""><code>LAMINAR_BASE_URL</code> 不要包含端口号，端口通过 <code>LAMINAR_HTTP_PORT</code> 和 <code>LAMINAR_GRPC_PORT</code> 单独配置</li>
<li class=""><code>LAMINAR_API_KEY</code> 请保密，不要提交到代码仓库</li>
<li class="">🔴 <strong>端口配置必须与服务器一致</strong>：如果你在服务器的 <code>.env</code> 文件中修改了 <code>APP_SERVER_HOST_PORT</code> 或 <code>APP_SERVER_GRPC_HOST_PORT</code>（默认为 8000/8001），客户端的 <code>LAMINAR_HTTP_PORT</code> 和 <code>LAMINAR_GRPC_PORT</code> <strong>必须修改为相同的端口号</strong></li>
</ul>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-安装-sdk">3. 安装 SDK<a href="#3-安装-sdk" class="hash-link" aria-label="3. 安装 SDK的直接链接" title="3. 安装 SDK的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="python-sdk">Python SDK<a href="#python-sdk" class="hash-link" aria-label="Python SDK的直接链接" title="Python SDK的直接链接" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip install lmnr==0.7.23</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-初始化客户端">4. 初始化客户端<a href="#4-初始化客户端" class="hash-link" aria-label="4. 初始化客户端的直接链接" title="4. 初始化客户端的直接链接" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="python-示例">Python 示例<a href="#python-示例" class="hash-link" aria-label="Python 示例的直接链接" title="Python 示例的直接链接" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 使用 initialize 方法初始化（推荐）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Laminar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">initialize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    project_api_key</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LAMINAR_API_KEY&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    base_url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LAMINAR_BASE_URL&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 🔴 重要：如果服务器 .env 中的端口不是 8000/8001，必须显式配置以下两个参数！</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http_port</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LAMINAR_HTTP_PORT&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 对应服务器 APP_SERVER_HOST_PORT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grpc_port</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LAMINAR_GRPC_PORT&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># 对应服务器 APP_SERVER_GRPC_HOST_PORT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<blockquote>
<p>⚠️ <strong>重要说明</strong>：</p>
<ul>
<li class=""><code>base_url</code> 只需要填写域名或 IP，<strong>不包含端口号</strong>（如 <code>http://192.128.3.1</code>）</li>
<li class=""><code>http_port</code> 和 <code>grpc_port</code> 必须是 <strong>整数类型</strong>，使用 <code>int()</code> 转换环境变量</li>
<li class="">🔴 <strong>端口配置检查：</strong>
<ul>
<li class="">如果服务器 <code>.env</code> 中 <strong>使用了默认端口 8000/8001</strong>：可以省略 <code>http_port</code> 和 <code>grpc_port</code> 参数</li>
<li class="">如果服务器 <code>.env</code> 中 <strong>修改了端口</strong>（如改为 9000/9001）：<strong>必须显式配置</strong> <code>http_port</code> 和 <code>grpc_port</code>，并与服务器保持一致</li>
</ul>
</li>
</ul>
<p><strong>端口对应关系：</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">服务器 .env 中的 APP_SERVER_HOST_PORT      → 客户端 LAMINAR_HTTP_PORT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">服务器 .env 中的 APP_SERVER_GRPC_HOST_PORT → 客户端 LAMINAR_GRPC_PORT</span><br></span></code></pre></div></div>
</blockquote>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="更多使用示例">更多使用示例<a href="#更多使用示例" class="hash-link" aria-label="更多使用示例的直接链接" title="更多使用示例的直接链接" translate="no">​</a></h4>
<h1>下面的示例默认已经初始化了，必须先初始化 Laminar，然后再使用 observe 装饰器</h1>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Laminar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">initialize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    project_api_key</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LAMINAR_API_KEY&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    base_url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LAMINAR_BASE_URL&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http_port</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LAMINAR_HTTP_PORT&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grpc_port</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LAMINAR_GRPC_PORT&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><strong>1. 使用 observe 装饰器追踪函数（推荐）</strong></p>
<p><code>@observe()</code> 装饰器是 Laminar 推荐的追踪方式，可以自动记录函数的输入、输出、执行时间等信息。</p>
<p><strong>基础用法：</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 自动追踪函数执行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;使用 observe 装饰器自动追踪 LLM 调用&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> openai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ChatCompletion</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;gpt-4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        messages</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;role&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 调用函数，会自动追踪</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hello, how are you?&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/laminar-image2-35cad12420c100150bbec49129611777.png" width="2198" height="468" class="img_ev3q"></p>
<p><strong><code>@observe()</code> 可用参数：</strong></p>
<table><thead><tr><th>参数</th><th>类型</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>name</code></td><td><code>str|None</code></td><td>自定义追踪的名称（默认使用函数名）</td><td><code>@observe(name=&quot;llm_call&quot;)</code></td></tr><tr><td><code>session_id</code></td><td><code>str|None</code></td><td>会话 ID，用于关联同一会话的多个追踪</td><td><code>@observe(session_id=&quot;session_123&quot;)</code></td></tr><tr><td><code>user_id</code></td><td><code>str|None</code></td><td>用户 ID，用于关联特定用户的追踪</td><td><code>@observe(user_id=&quot;user_456&quot;)</code></td></tr><tr><td><code>metadata</code></td><td><code>dict[str, Any]</code></td><td>自定义元数据，必须可 JSON 序列化</td><td><code>@observe(metadata={&quot;model&quot;: &quot;gpt-4&quot;})</code></td></tr><tr><td><code>tags</code></td><td><code>list[str]</code></td><td>标签列表，用于分类和过滤</td><td><code>@observe(tags=[&quot;production&quot;, &quot;critical&quot;])</code></td></tr><tr><td><code>ignore_input</code></td><td><code>bool</code></td><td>如果为 True，不记录输入参数</td><td><code>@observe(ignore_input=True)</code></td></tr><tr><td><code>ignore_output</code></td><td><code>bool</code></td><td>如果为 True，不记录输出结果</td><td><code>@observe(ignore_output=True)</code></td></tr><tr><td><code>ignore_inputs</code></td><td><code>list[str]</code></td><td>要跳过的输入参数名称列表</td><td><code>@observe(ignore_inputs=[&quot;password&quot;])</code></td></tr><tr><td><code>input_formatter</code></td><td><code>Callable</code></td><td>格式化输入参数的函数</td><td><code>@observe(input_formatter=custom_fmt)</code></td></tr><tr><td><code>output_formatter</code></td><td><code>Callable</code></td><td>格式化输出结果的函数</td><td><code>@observe(output_formatter=custom_fmt)</code></td></tr></tbody></table>
<p><strong>详细示例：</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 示例 1：自定义追踪名称, 添加元数据和用户信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;generate_summary&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         metadata</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;ollama_model&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;llama3.1&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         session_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         tags</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;text_generation&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">chat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">completions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;model_name&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        messages</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;role&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/laminar-image3-5c8f6a77d25f411237608ced8264ecc2.png" width="3044" height="158" class="img_ev3q"></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 示例 2：使用Session_ID进行对话隔离</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;generate_summary&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">session_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">tags</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;zh-CN&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">chat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">completions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;llama3.1:latest&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        messages</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;role&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;HelloWorld&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;456&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">session_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;def&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">tags</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;zh-CN&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">chat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">completions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;llama3.1:latest&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        messages</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;role&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/laminar-image4-983075b2844c8921935fc0e10c0b8888.png" width="2994" height="704" class="img_ev3q"></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 示例 3：嵌套追踪（追踪复杂工作流）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 基础 LLM 调用函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;generate_text&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    session_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tags</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;zh-CN&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;llm&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;base_call&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;model&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;llama3.1:latest&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;统一的 LLM 调用入口&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">chat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">completions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;llama3.1:latest&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        messages</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;role&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prompt</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 子步骤 1：提取关键词</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;extract_keywords&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    session_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tags</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;zh-CN&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;llm&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;keywords&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">extract_keywords</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    使用 LLM 从文本中提取关键词。</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    内部调用 generate_text，会自动嵌套追踪。</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prompt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;请从下面这段文本中提取 5~10 个最重要的中文关键词。</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">要求：</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">- 只输出关键词本身</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">- 用中文逗号或英文逗号分隔</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">- 不要加多余解释</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">文本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c"></span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">text</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    raw </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 按中英文逗号切分，去除空格</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keywords </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">kw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> kw </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&quot;[，,]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> raw</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> kw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> keywords</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 子步骤 2：生成摘要</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;generate_summary&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    session_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tags</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;zh-CN&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;llm&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;summary&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate_summary</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    使用 LLM 对文本生成摘要。</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    内部调用 generate_text，会自动嵌套追踪。</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prompt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;请用中文为下面这段文本生成一个简短摘要：</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">要求：</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">- 3~5 句</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">- 保留核心信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">- 不要出现“摘要如下”之类的客套话</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">文本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c"></span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">text</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    summary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> summary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 顶层管道：组合多个步骤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;process_document&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    session_id</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tags</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;pipeline&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;document&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;zh-CN&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">process_document</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc_text</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    文档处理管道：</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    1. extract_keywords - 提取关键词（有自己的 span）</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    2. generate_summary - 生成摘要（有自己的 span）</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    两个子函数内部会调用 generate_text（再嵌套一层 span）</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keywords </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> extract_keywords</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc_text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    summary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_summary</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc_text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;keywords&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> keywords</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;summary&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> summary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="alt text" src="/assets/images/laminar-image5-31cd118ab9945cdfbe970055caafd732.png" width="1884" height="976" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-核心功能">🔧 核心功能<a href="#-核心功能" class="hash-link" aria-label="🔧 核心功能的直接链接" title="🔧 核心功能的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="追踪和监控-tracing">追踪和监控 Tracing<a href="#追踪和监控-tracing" class="hash-link" aria-label="追踪和监控 Tracing的直接链接" title="追踪和监控 Tracing的直接链接" translate="no">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> lmnr </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> observe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate_response</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_input</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;自动追踪函数调用&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> llm_call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 手动添加元数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">metadata</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;user_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;123&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;session_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chat_with_context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 你的逻辑</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="评估和测试-evaluation">评估和测试 Evaluation<a href="#评估和测试-evaluation" class="hash-link" aria-label="评估和测试 Evaluation的直接链接" title="评估和测试 Evaluation的直接链接" translate="no">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> lmnr </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> evaluate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定义评估数据集</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;input&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;什么是 AI？&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;expected&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;人工智能...&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;input&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;解释机器学习&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;expected&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;机器学习是...&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 运行评估</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> laminar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;qa-evaluation&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataset</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    evaluator</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">your_llm_function</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metrics</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;accuracy&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;latency&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;平均准确率: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">results</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;accuracy&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-数据可视化">📊 数据可视化<a href="#-数据可视化" class="hash-link" aria-label="📊 数据可视化的直接链接" title="📊 数据可视化的直接链接" translate="no">​</a></h2>
<p>Laminar 提供了丰富的可视化界面：</p>
<ol>
<li class=""><strong>调用链路图</strong>：查看完整的 LLM 调用链路</li>
<li class=""><strong>成本分析</strong>：实时追踪 API 调用成本</li>
<li class=""><strong>性能指标</strong>：响应时间、Token 使用量等</li>
<li class=""><strong>错误监控</strong>：快速定位和调试问题</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-最佳实践">🎯 最佳实践<a href="#-最佳实践" class="hash-link" aria-label="🎯 最佳实践的直接链接" title="🎯 最佳实践的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-合理使用标签和元数据">1. 合理使用标签和元数据<a href="#1-合理使用标签和元数据" class="hash-link" aria-label="1. 合理使用标签和元数据的直接链接" title="1. 合理使用标签和元数据的直接链接" translate="no">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> laminar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">start_as_current_span</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;user-query&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attributes</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;user_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;query_type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;search&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;model&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;gpt-4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 你的代码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-设置合理的采样率">2. 设置合理的采样率<a href="#2-设置合理的采样率" class="hash-link" aria-label="2. 设置合理的采样率的直接链接" title="2. 设置合理的采样率的直接链接" translate="no">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 生产环境可能不需要追踪所有请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">laminar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Laminar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    api_key</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;your-key&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sample_rate</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 采样 10% 的请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-使用环境变量管理配置">3. 使用环境变量管理配置<a href="#3-使用环境变量管理配置" class="hash-link" aria-label="3. 使用环境变量管理配置的直接链接" title="3. 使用环境变量管理配置的直接链接" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export LAMINAR_API_KEY=&quot;your-api-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export LAMINAR_PROJECT_ID=&quot;your-project-id&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export LAMINAR_ENVIRONMENT=&quot;production&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-安全性">🔐 安全性<a href="#-安全性" class="hash-link" aria-label="🔐 安全性的直接链接" title="🔐 安全性的直接链接" translate="no">​</a></h2>
<ul>
<li class="">✅ API 密钥通过环境变量管理，不要硬编码</li>
<li class="">✅ 敏感数据可以配置过滤规则</li>
<li class="">✅ 支持私有部署选项</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-进阶功能">📚 进阶功能<a href="#-进阶功能" class="hash-link" aria-label="📚 进阶功能的直接链接" title="📚 进阶功能的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="自定义评估器">自定义评估器<a href="#自定义评估器" class="hash-link" aria-label="自定义评估器的直接链接" title="自定义评估器的直接链接" translate="no">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> lmnr </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BaseEvaluator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">CustomEvaluator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BaseEvaluator</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> output</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expected</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 自定义评估逻辑</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> calculate_similarity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expected</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;score&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> score</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;passed&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> score </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 使用自定义评估器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">laminar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataset</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">test_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    evaluator</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">CustomEvaluator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="集成其他工具">集成其他工具<a href="#集成其他工具" class="hash-link" aria-label="集成其他工具的直接链接" title="集成其他工具的直接链接" translate="no">​</a></h3>
<p>Laminar 可以与以下工具集成：</p>
<ul>
<li class=""><strong>LangChain</strong>：自动追踪 LangChain 应用</li>
<li class=""><strong>OpenAI</strong>：直接集成 OpenAI API 调用</li>
<li class=""><strong>Anthropic</strong>：支持 Claude 模型追踪</li>
<li class=""><strong>Hugging Face</strong>：兼容开源模型</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="️-故障排查">🛠️ 故障排查<a href="#️-故障排查" class="hash-link" aria-label="🛠️ 故障排查的直接链接" title="🛠️ 故障排查的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="常见问题">常见问题<a href="#常见问题" class="hash-link" aria-label="常见问题的直接链接" title="常见问题的直接链接" translate="no">​</a></h3>
<p><strong>Q: 追踪数据没有显示？</strong></p>
<p>A: 检查以下项：</p>
<ul>
<li class="">API Key 是否正确配置</li>
<li class="">网络连接是否正常</li>
<li class="">是否在正确的项目下查看</li>
</ul>
<p><strong>Q: 如何减少延迟？</strong></p>
<p>A:</p>
<ul>
<li class="">使用异步发送模式</li>
<li class="">降低采样率</li>
<li class="">批量发送追踪数据</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">laminar </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Laminar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    api_key</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;your-key&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    async_mode</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-相关资源">📖 相关资源<a href="#-相关资源" class="hash-link" aria-label="📖 相关资源的直接链接" title="📖 相关资源的直接链接" translate="no">​</a></h2>
<ul>
<li class=""><a href="https://docs.lmnr.ai" target="_blank" rel="noopener noreferrer" class="">官方文档</a></li>
<li class=""><a href="https://github.com/lmnr-ai/lmnr" target="_blank" rel="noopener noreferrer" class="">GitHub 仓库</a></li>
<li class=""><a href="https://docs.lmnr.ai/api-reference" target="_blank" rel="noopener noreferrer" class="">API 参考</a></li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="-总结">💡 总结<a href="#-总结" class="hash-link" aria-label="💡 总结的直接链接" title="💡 总结的直接链接" translate="no">​</a></h2>
<p>Laminar 是一个功能强大的 LLM 开发平台，通过它你可以：</p>
<p>✅ 更好地管理和版本化提示词<br>
<!-- -->✅ 实时监控应用性能和成本<br>
<!-- -->✅ 自动化测试和评估 AI 输出<br>
<!-- -->✅ 快速调试和优化 LLM 应用</p>
<p>开始使用 Laminar，让你的 AI 应用开发更加高效！🚀</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/wxytjustb/rokywang/tree/main/docs/01-ai-dev/Laminar/laminar.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--next" href="/docs/ai-dev/claude-code/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">使用claude code 进行开发</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-简介" class="table-of-contents__link toc-highlight">📖 简介</a><ul><li><a href="#核心能力概览" class="table-of-contents__link toc-highlight">核心能力概览</a></li></ul></li><li><a href="#️-本地部署-laminar-服务器" class="table-of-contents__link toc-highlight">🏗️ 本地部署 Laminar 服务器</a><ul><li><a href="#-部署流程概览" class="table-of-contents__link toc-highlight">📋 部署流程概览</a></li><li><a href="#使用-docker-compose-部署" class="table-of-contents__link toc-highlight">使用 Docker Compose 部署</a></li><li><a href="#-docker-compose-文件选择" class="table-of-contents__link toc-highlight">📦 Docker Compose 文件选择</a></li><li><a href="#-快速配置检查清单" class="table-of-contents__link toc-highlight">🔍 快速配置检查清单</a></li><li><a href="#验证部署" class="table-of-contents__link toc-highlight">验证部署</a></li><li><a href="#常见问题排查" class="table-of-contents__link toc-highlight">常见问题排查</a></li></ul></li><li><a href="#-快速开始" class="table-of-contents__link toc-highlight">🚀 快速开始</a><ul><li><a href="#1-获取-api-key" class="table-of-contents__link toc-highlight">1. 获取 API Key</a></li><li><a href="#2-配置环境变量" class="table-of-contents__link toc-highlight">2. 配置环境变量</a></li><li><a href="#3-安装-sdk" class="table-of-contents__link toc-highlight">3. 安装 SDK</a></li><li><a href="#4-初始化客户端" class="table-of-contents__link toc-highlight">4. 初始化客户端</a></li></ul></li><li><a href="#-核心功能" class="table-of-contents__link toc-highlight">🔧 核心功能</a><ul><li><a href="#追踪和监控-tracing" class="table-of-contents__link toc-highlight">追踪和监控 Tracing</a></li><li><a href="#评估和测试-evaluation" class="table-of-contents__link toc-highlight">评估和测试 Evaluation</a></li></ul></li><li><a href="#-数据可视化" class="table-of-contents__link toc-highlight">📊 数据可视化</a></li><li><a href="#-最佳实践" class="table-of-contents__link toc-highlight">🎯 最佳实践</a><ul><li><a href="#1-合理使用标签和元数据" class="table-of-contents__link toc-highlight">1. 合理使用标签和元数据</a></li><li><a href="#2-设置合理的采样率" class="table-of-contents__link toc-highlight">2. 设置合理的采样率</a></li><li><a href="#3-使用环境变量管理配置" class="table-of-contents__link toc-highlight">3. 使用环境变量管理配置</a></li></ul></li><li><a href="#-安全性" class="table-of-contents__link toc-highlight">🔐 安全性</a></li><li><a href="#-进阶功能" class="table-of-contents__link toc-highlight">📚 进阶功能</a><ul><li><a href="#自定义评估器" class="table-of-contents__link toc-highlight">自定义评估器</a></li><li><a href="#集成其他工具" class="table-of-contents__link toc-highlight">集成其他工具</a></li></ul></li><li><a href="#️-故障排查" class="table-of-contents__link toc-highlight">🛠️ 故障排查</a><ul><li><a href="#常见问题" class="table-of-contents__link toc-highlight">常见问题</a></li></ul></li><li><a href="#-相关资源" class="table-of-contents__link toc-highlight">📖 相关资源</a></li><li><a href="#-总结" class="table-of-contents__link toc-highlight">💡 总结</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 指南针Compass, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>